---
import HeaderLink from '@/components/HeaderLink'
import GithubIcon from '@/components/icons/Github'
// import Search from '@/components/Search'
import Search from 'astro-pagefind/components/Search'
import BurgerIcon from '@/components/icons/Burger'
import ToggleTheme from '@/components/ToggleTheme'
import LanguagePicker from '@/components/LanguagePicker'
import Modal from '@/components/Modal'
import { getLangFromUrl, useTranslations } from '@/i18n/utils'

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)
---

<header class="flex justify-between items-center h-12 font-semibold">
  <a class="text-xl transition-all hover:font-bold" href="/">nano-blog</a>

  <section class="z-50">
    <nav class="flex justify-between gap-3">
      <section class="hidden md:flex gap-3 mr-3">
        <HeaderLink href={lang === 'en' ? '/' : `/${lang}`}>
          {t('nav.home')}
        </HeaderLink>
        <HeaderLink href={lang === 'en' ? '/tags' : `/${lang}/tags`}>
          {t('nav.tags')}
        </HeaderLink>
        <HeaderLink href={lang === 'en' ? '/about' : `/${lang}/about`}>
          {t('nav.about')}
        </HeaderLink>
      </section>

      <LanguagePicker />

      <a
        href="https://github.com/gaomingzhao666/nano-blog"
        target="_blank"
        aria-label="Open Github"><GithubIcon /></a
      >

      <!-- <Search aria-label="Search Blog Contents" /> -->
      <Search
        id="search1"
        className="pagefind-ui yellow"
        uiOptions={{ showImages: false }}
      />
      <ToggleTheme aria-label="Switch Blog Theme" />

      <nav class="md:hidden">
        <Modal
          title={t('nav.navigation')}
          contents={[
            { label: t('nav.home'), link: lang === 'en' ? '/' : `/${lang}` },
            {
              label: t('nav.tags'),
              link: lang === 'en' ? '/tags' : `/${lang}/tags`,
            },
            {
              label: t('nav.about'),
              link: lang === 'en' ? '/about' : `/${lang}/about`,
            },
          ]}
          type="outline"
        >
          <BurgerIcon aria-label="Open Navigation on Mobile Devices" />
        </Modal>
      </nav>
    </nav>
  </section>
</header>

<style>
  .pagefind-ui {
    --pagefind-ui-scale: 0.75;
    --pagefind-ui-primary: navy;
    --pagefind-ui-text: black;
    --pagefind-ui-border: slategrey;
    --pagefind-ui-border-width: 1px;
    --pagefind-ui-border-radius: 0.25rem;
    --pagefind-ui-font: sans-serif;

    width: 50%;
  }

  .pagefind-ui.yellow {
    --pagefind-ui-background: lightyellow;
  }

  .pagefind-ui.red {
    --pagefind-ui-background: peachpuff;
    width: 100%;
  }

  .pagefind-ui .pagefind-ui__drawer:not(.pagefind-ui__hidden) {
    position: absolute;
    left: 0;
    right: 0;
    margin-top: 0px;
    z-index: 9999;
    padding: 0 2em 1em;
    overflow-y: auto;
    box-shadow:
      0 10px 10px -5px rgba(0, 0, 0, 0.2),
      0 2px 2px 0 rgba(0, 0, 0, 0.1);
    border-bottom-right-radius: var(--pagefind-ui-border-radius);
    border-bottom-left-radius: var(--pagefind-ui-border-radius);
    background-color: var(--pagefind-ui-background);
  }

  .pagefind-ui .pagefind-ui__result-link {
    color: var(--pagefind-ui-primary);
  }

  .pagefind-ui .pagefind-ui__result-excerpt {
    color: var(--pagefind-ui-text);
  }
</style>
